
            "Type": "AWS::EC2::Subnet::Id",
            "Description": "Select the Subnet Id where the PVWA instance will reside."
        },
        "PSMInstanceName": {
            "Type": "String",
            "Description": "Enter a name for the PSM instance.",
            "Default": "CyberArk PSM"
        },
        "PSMInstanceType": {
            "Type": "String",
            "Description": "Select the instance type of the PSM instance.",
            "AllowedValues": [
                "c4.2xlarge",
                "c4.4xlarge",
                "c4.8xlarge"
            ],
            "Default": "c4.2xlarge"
        },
        "PSMInstanceSecurityGroups": {
            "Type": "List<AWS::EC2::SecurityGroup::Id>",
            "Description": "Assign Security Groups to the PSM instance."
        },
		"PSMInstanceSubnetId": {
            "Type": "AWS::EC2::Subnet::Id",
            "Description": "Select the Subnet Id where the PSM instance will reside."
        },
		"PSMPInstanceName": {
            "Type": "String",
            "Description": "Enter a name for the PSM SSH Proxy instance.",
            "Default": "CyberArk PSM SSH Proxy"
        },
		"PSMPInstanceType": {
            "Type": "String",
            "Description": "Select the instance type of the PSM SSH Proxy instance.",
            "AllowedValues": [
                "m4.large",
                "m4.xlarge",
                "m4.2xlarge",
                "m4.4xlarge"
            ],
            "Default": "m4.large"
        },
		"PSMPInstanceSecurityGroups": {
            "Type": "List<AWS::EC2::SecurityGroup::Id>",
            "Description": "Assign Security Groups to the PSM SSH Proxy instance."
        },
		"PSMPInstanceSubnetId": {
            "Type": "AWS::EC2::Subnet::Id",
            "Description": "Select the Subnet Id where the PSM SSH Proxy instance will reside."
        }
    },
    "Conditions": {
        "EULACondition": {
            "Fn::Equals": [
                "Accept",
                {
                    "Ref": "EULA"
                }
            ]
        }
    },
    "Rules": {
        "PasswordConfirmation": {
            "Assertions": [
              {
                "Assert" : {"Fn::Equals": [{"Ref": "VaultMasterPassword"}, {"Ref": "RetypeMasterPassword"}]},
                "AssertDescription": "The password confirmation does not match."
              },
			  {
                "Assert" : {"Fn::Equals": [{"Ref": "VaultAdminPassword"}, {"Ref": "RetypeAdminPassword"}]},
                "AssertDescription": "The password confirmation does not match."
              },
			  {
                "Assert" : {"Fn::Equals": [{"Ref": "VaultDRPassword"}, {"Ref": "RetypeDRPassword"}]},
                "AssertDescription": "The password confirmation does not match."
              }
            ]
        }
    },
    "Metadata": {
        "AWS::CloudFormation::Interface": {
            "ParameterGroups": [
                {
                    "Label": {
                        "default": "General parameters"
                    },
                    "Parameters": [
                        "EULA",
                        "KeyName",
                        "VaultFilesBucket",
                        "LicenseFile",
                        "RecoveryPublicKey"
                    ]
                },
                {
                    "Label": {
                        "default": "Vault and Vault DR configuration"
                    },
                    "Parameters": [
                        "VaultInstanceName",
                        "VaultMasterPassword",
						"RetypeMasterPassword",
                        "VaultAdminPassword",
						"RetypeAdminPassword",
						"VaultDRPassword",
						"RetypeDRPassword",
                        "VaultInstanceType",
                        "VaultInstanceSecurityGroups",
                        "VaultInstanceSubnetId",
                        "DRInstanceSubnetId"
                    ]
                },
                {
                    "Label": {
                        "default": "CPM configuration"
                    },
                    "Parameters": [
                        "CPMInstanceName",
                        "CPMInstanceType",
                        "CPMInstanceSecurityGroups",
                        "CPMInstanceSubnetId"
                    ]
                },
                {
                    "Label": {
                        "default": "PVWA configuration"
                    },
                    "Parameters": [
                        "PVWAInstanceName",
                        "PVWAInstanceType",
                        "PVWAInstanceSecurityGroups",
                        "PVWAInstanceSubnetId"
                    ]
                },
                {
                    "Label": {
                        "default": "PSM configuration"
                    },
                    "Parameters": [
                        "PSMInstanceName",
                        "PSMInstanceType",
                        "PSMInstanceSecurityGroups",
						"PSMInstanceSubnetId"
                    ]
                },
				{
                    "Label": {
                        "default": "PSM SSH Proxy configuration"
                    },
                    "Parameters": [
                        "PSMPInstanceName",
                        "PSMPInstanceType",
                        "PSMPInstanceSecurityGroups",
						"PSMPInstanceSubnetId"
                    ]
                }
            ],
            "ParameterLabels": {
                "EULA": {
                    "default": "License Agreement"
                },
                "KeyName": {
                    "default": "Key Pair"
                },
                "VaultFilesBucket": {
                    "default": "Vault Files Bucket"
                },
                "LicenseFile": {
                    "default": "License File"
                },
                "RecoveryPublicKey": {
                    "default": "Recovery Public Key"
                },
                "VaultInstanceName": {
                    "default": "Vault Instance Name"
                },
                "VaultMasterPassword": {
                    "default": "Vault Master Password"
                },
				"RetypeMasterPassword": {
                    "default": "Retype Master Password"
                },
                "VaultAdminPassword": {
                    "default": "Vault Admin Password"
				},
				"RetypeAdminPassword": {
                    "default": "Retype Admin Password"
                },
				"VaultDRPassword": {
                    "default": "DR Password"
                },
				"RetypeDRPassword": {
                    "default": "Retype DR Password"
                },
                "VaultInstanceType": {
                    "default": "Vault and Vault DR Instance Type"
                },
                "VaultInstanceSecurityGroups": {
                    "default": "Vault Security Groups"
                },
                "VaultInstanceSubnetId": {
                    "default": "Vault Instance Subnet Id"
                },
                "DRInstanceSubnetId": {
                    "default": "Vault DR Instance Subnet Id"
                },
                "CPMInstanceName": {
                    "default": "CPM Instance Name"
                },
                "CPMInstanceType": {
                    "default": "CPM Instance Type"
                },
                "CPMInstanceSecurityGroups": {
                    "default": "CPM Instance Security Groups"
                },
                "CPMInstanceSubnetId": {
                    "default": "CPM Instance Subnet Id"
                },
                "PVWAInstanceName": {
                    "default": "PVWA Instance Name"
                },
                "PVWAInstanceType": {
                    "default": "PVWA Instance Type"
                },
                "PVWAInstanceSecurityGroups": {
                    "default": "PVWA Instance Security Groups"
                },
                "PVWAInstanceSubnetId": {
                    "default": "PVWA Instance Subnet Id"
                },
                "PSMInstanceName": {
                    "default": "PSM Instance Name"
                },
                "PSMInstanceType": {
                    "default": "PSM Instance Type"
                },
                "PSMInstanceSecurityGroups": {
                    "default": "PSM Instance Security Groups"
                },
				"PSMInstanceSubnetId": {
                    "default": "PSM Instance Subnet Id"
                },
				"PSMPInstanceName": {
                    "default": "PSM SSH Proxy Instance Name"
                },
				"PSMPInstanceType": {
                    "default": "PSM SSH Proxy Instance Type"
                },
				"PSMPInstanceSecurityGroups": {
                    "default": "PSM SSH Proxy Instance Security Groups"
                },
				"PSMPInstanceSubnetId": {
                    "default": "PSM SSH Proxy Instance Subnet Id"
                }
            }
        }
    },
    "Mappings": {
        "RegionMap": {
            "us-east-1": {
                "Vault": "ami-0f5ec5156d710a17d",
                "Components": "ami-0b1a58bb5b5a78b3b",
                "CPM": "ami-04297c47b96216bc5",
                "PVWA": "ami-09e356fcd13ab5322",
                "PSM": "ami-041d5a44246c242d6",
                "PSMP": "ami-0defaf6be121916f3"
            },
            "eu-west-2": {
                "Vault": "ami-074ee03bfbfff5fda",
                "Components": "ami-0c92618583f701176",
                "CPM": "ami-079a10f6ba5c4eeb4",
                "PVWA": "ami-046e947dcae85aafb",
                "PSM": "ami-0e6d2cea1cf1d0275",
                "PSMP": "ami-07f89768f972c452d"
            },
            "us-west-1": {
                "Vault": "ami-07299e5004f82cd23",
                "Components": "ami-0c5a6a83a10cb26f6",
                "CPM": "ami-07c541154a7e96144",
                "PVWA": "ami-097c5f4e826713cdc",
                "PSM": "ami-05d0a3a64d916a9ac",
                "PSMP": "ami-05dc3895953bbb30a"
            },
            "us-west-2": {
                "Vault": "ami-04bcd462788163d5e",
                "Components": "ami-03ba37302025864d6",
                "CPM": "ami-0c5cb23b443a850cd",
                "PVWA": "ami-072e7e3ea1b3a8c66",
                "PSM": "ami-09044a911cd7607d6",
                "PSMP": "ami-0e385d7a54dd97c29"
            },
            "ca-central-1": {
                "Vault": "ami-031efdcf451f76851",
                "Components": "ami-0c4cfb708d8b6eb90",
                "CPM": "ami-07794b680287e83f7",
                "PVWA": "ami-08ab8db5ba0c00f78",
                "PSM": "ami-0560ae7636022d241",
                "PSMP": "ami-0a3770ee62a03ae54"
            },
			"eu-west-1": {
                "Vault": "ami-055875a33d1855454",
                "Components": "ami-0929c8dfe71e7caa6",
                "CPM": "ami-020e9f9fbc526c078",
                "PVWA": "ami-0e94dfc838d034ac6",
                "PSM": "ami-098a84a8de32990bd",
                "PSMP": "ami-07e5542d089692bc2"
            },
			"eu-central-1": {
                "Vault": "ami-070990fb0a4adcb1c",
                "Components": "ami-0b7366d5a32014f5f",
                "CPM": "ami-04fece7e673892d18",
                "PVWA": "ami-0d78264adddbf0e09",
                "PSM": "ami-0d7a9a6ebd8620ba7",
                "PSMP": "ami-0552713509028f263"
            },
            "eu-west-2": {
                "Vault": "ami-f66a8891",
                "Components": "ami-0ce70a6b",
                "CPM": "ami-0ce70a6b",
                "PVWA": "ami-0ce70a6b",
                "PSM": "ami-0ce70a6b",
                "PSMP": "ami-a99674ce"
            },
			"ap-southeast-1": {
                "Vault": "ami-0adec27e3d97acd46",
                "Components": "ami-05943d8fc0385ac36",
                "CPM": "ami-0b23b9f2a11c03e5e",
                "PVWA": "ami-0000bd3a98e040b6d",
                "PSM": "ami-0e5b9367ec4cd4d82",
                "PSMP": "ami-029e0bb6069e7afd8"
            },
			"ap-southeast-2": {
                "Vault": "ami-076c51f5281dc1139",
                "Components": "ami-0bd6311d26ddb7c8e",
                "CPM": "ami-0a8ef23737b1ba7f0",
                "PVWA": "ami-0c1b309ab91825a56",
                "PSM": "ami-00da2f855a0ae8a3a",
                "PSMP": "ami-0b33117017a0627ac"
            },
			"ap-northeast-2": {
                "Vault": "ami-0095711fbd0234bb5",
                "Components": "ami-00c130264e5feba9e",
                "CPM": "ami-056f7261892b501f8",
                "PVWA": "ami-09772e4a0f0d37718",
                "PSM": "ami-00d3b879e3daaded2",
                "PSMP": "ami-0bee3849042c5f67e"
            },
			"ap-northeast-1": {
                "Vault": "ami-023a9797d305d37cd",
                "Components": "ami-031857c6252af5e59",
                "CPM": "ami-042a9b4c302b117da",
                "PVWA": "ami-0c6e1d4aa4c75ff02",
                "PSM": "ami-05724a67e503a9513",
                "PSMP": "ami-04e8a59042a5e181b"
            },
            "ap-south-1": {
                "Vault": "ami-094b09c2952027426",
                "Components": "ami-03793b4dca2f75186",
                "CPM": "ami-0ddb8f72eaacc45ef",
                "PVWA": "ami-0dd19ebb4d09508cc",
                "PSM": "ami-0231d3b20edbcfadc",
                "PSMP": "ami-0f64dbebffa1acdca"
            },
            "sa-east-1": {
                "Vault": "ami-0f63a29405c49eac9",
                "Components": "ami-0ecd0542b88a4833c",
                "CPM": "ami-09674547d0d8cc81a",
                "PVWA": "ami-01a3f3486b3326c0b",
                "PSM": "ami-0e38b8a579840237e",
                "PSMP": "ami-04ccb81bb661e9db7"
            },
            "us-gov-west-1": {
                "Vault": "ami-815ac4e0",
                "Components": "ami-875ac4e6",
                "CPM": "ami-875ac4e6",
                "PVWA": "ami-875ac4e6",
                "PSM": "ami-875ac4e6",
                "PSMP": "ami-ba5ac4db"
            }
        }
    }
}

